<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="css/style.css">
  <title>Projeto idividuas</title>
</head>
<!-- Palheta de cores 
#0D1B2A
#1B263B
#415A77
#778DA9
#E0E1DD -->

<body>
  <nav>
    <div id="logo">
      <img src="assets/icon/logo proheto idividuas.png" id="imgLogo" alt="">
    </div>
    <ul id="listHome">
      <li></li>
      <li><a href="#">Home</a> </li>

      <li><a href="#">Livros</a></li>

      <li><a href="#">Pedir ajuda</a></li>

      <li><a href="#">Contatos</a></li>
    </ul>

    <div id="perfil">
      <a href="" id="perfilUsuario"></a>
    </div>
  </nav>

  <div id="carousel">

    <button onclick="voltar()">""</button>

    <div id="imagemCarousel">
      
    </div>

    <button id="passar" onclick="passar()">""</button>
  </div>

  <div id="text_novos">
    <h1>
      Mangás lançados recentemente</h1>
  </div>
  <DIV id="div_novos">



    <div id="novo">
    </div>

  </DIV>



  <div id="div_pesquisa"> <input type="text" id="pesquisar_input"> <button onclick="pesquisar()">Pesquisar</button>
  </div>
  <div id="biblioteca">

    <div id="genero">
      <ul>
        <li><a href="#">Romance</a></li>
        <li><a href="#" >Jogos</a></li>
        <li><a href="#">Ação</a></li>
        <li><a href="#">Comédia</a></li>
        <li><a href="#">Terror</a></li>
        <li><a href="#">Mistério</a></li>
        <li><a href="#">Aventura</a></li>
        <li><a href="#">Ficção ciientífica</a></li>
        <li><a href="#">Fantasia</a></li>
        <li><a href="#">História</a></li>
      </ul>
    </div>
    <div id="estante">
    </div>
  </div>



  <footer>
    <div>
      Eu sou ele
      <br style="margin-top: 0%; background-color: black;">
      ele é eu
      <br>
    </div>
    <div>
      Rua Haddock Lobo,
      595 - Cerqueira
      <br>
      César, São Paulo - SP, 01414-001
    </div>

    <div>
      links
    </div>

    <div>
      (11) 97409-3996
      <br>atendimento@sptech.school
      <br>FAQ - SPTech
    </div>
  </footer>
</body>

<a href="cadastro.html"></a>
</html>
<script>


  // var novoss = [`<img src="https://m.media-amazon.com/images/I/5191HKIfUPL._SY344_BO1,204,203,200_QL70_ML2_.jpg" id="itemNovos" alt="">`];
  // var i = 0;
  // while (i < 4) {
  //   i++
  //   novo.innerHTML += novoss[0];
  // }
  if(sessionStorage.NOME_USUARIO == undefined ){
      perfilUsuario.innerHTML = "Entre já"
      perfilUsuario.href = "cadastro.html"
  }else{
    perfilUsuario.innerHTML = sessionStorage.NOME_USUARIO
  }
  fetch("/avisos/maisRecentes").then(function (recentesResposta) {
    if (recentesResposta.ok) {
      if (recentesResposta.status == 204) {
      }

      recentesResposta.json().then(function (recentesResposta) {
        console.log("Dados recebidos: ", JSON.stringify(recentesResposta));
        console.log(recentesResposta);
        var feed = document.getElementById("feed_container");

        for (var i = 0; i < 4; i++) {
          var recentes = recentesResposta[i];
          console.log(recentes);
          novo.innerHTML += `
            <img src="${recentes.linkImagem}" id="itemNovos" alt="">
          `
        }

      });
    } else {
      throw ('Houve um erro na API!');
    }
  }).catch(function (resposta) {
    console.error(resposta);
  });




  fetch("/avisos/listarLivro").then(function (resposta) {
    if (resposta.ok) {
      if (resposta.status == 204) {
      }

      resposta.json().then(function (resposta) {
        console.log("Dados recebidos: ", JSON.stringify(resposta));
        console.log(resposta);
        var feed = document.getElementById("feed_container");

        for (var i = 0; i < resposta.length; i++) {
          var publicacao = resposta[i];

          var panel = document.createElement("a");

          estante.innerHTML += `
            <a id="container"  onclick="pagManga(${publicacao.idManga})"> 
              <img src="${publicacao.linkImagem}" id="imgLivro"  alt="">
            </a>

          `
        }

      });
    } else {
      throw ('Houve um erro na API!');
    }
  }).catch(function (resposta) {
    console.error(resposta);
  });


  function pagManga(idManga) {
    sessionStorage.ID_PAGINA_MANGA = idManga;

    console.log("cliquei na pagina  - " + idManga);
    console.log("Você será redirecionado à página de edição do aviso de id número: " + idManga);
    window.location = "/pagManga.html"

  }
  /*------------------------------Pesqui9sa----------------------------------------------------*/

  function pesquisar() {
    var pesquisarVar = pesquisar_input.value;
    fetch(`avisos/pesquisar/${pesquisarVar}`).then(function (resposta) {
      if (resposta.ok) {

        if (resposta.status == 204) {
          alert("Nenhum resultado encontrado.");

        }

        resposta.json().then(function (resposta) {
          console.log("Dados recebidos: ", JSON.stringify(resposta));
          console.log(resposta);

          estante.innerHTML = ``
          for (var i = 0; i < resposta.length; i++) {
            var pesquisa = resposta[i];

            estante.innerHTML += `
            <a id="container" onclick="pagManga(${pesquisa.idManga})"> 
              <img src="${pesquisa.linkImagem}" id="imgLivro"  alt="">
            </a>
            
          `;
          }

        });
      } else {
        throw ('Houve um erro na API!');
      }
    }).catch(function (resposta) {
      console.error(resposta);
    });
  }



  /*------------------------------CAROUSEL----------------------------------------------------*/
  var num = 2;
  imagemCarousel.innerHTML = `<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/49/Mango_-_single.jpg/1024px-Mango_-_single.jpg" alt="">`

  var carousel = {
    verificar: function () {
      if (num == 0) {
        num = 3;
      } else if (num == 4) {
        num = 1;
      }
    },
    imgCarousel: function () {
      if (num == 1) {
        imagemCarousel.innerHTML = `<img src="https://static.mundoeducacao.uol.com.br/mundoeducacao/2021/05/manga.jpg" alt="">`

      } if (num == 2) {
        imagemCarousel.innerHTML = `<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/49/Mango_-_single.jpg/1024px-Mango_-_single.jpg" alt="">`

      } if (num == 3) {
        imagemCarousel.innerHTML = `<img src="https://static.mundoeducacao.uol.com.br/mundoeducacao/2021/05/manga.jpg" alt="">`
      }
    },
  }

  setInterval(function () {
    passar();
  }, 3001);



  function voltar() {
    num--;
    carousel.verificar();
    carousel.imgCarousel();
  }

  function passar() {
    num++;
    carousel.verificar();
    carousel.imgCarousel();
  }
  /*------------------------------FIM CAROUSEL----------------------------------------------------*/

</script>